var U=Object.defineProperty;var $=(o,t,e)=>t in o?U(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var l=(o,t,e)=>($(o,typeof t!="symbol"?t+"":t,e),e);import{S as H,D as M,i as J,I as G,a as K,b as Q,c as Y,d as X,e as Z,f as ee,g as te,h as se,j as ie,k as oe,l as ne,m as ae,n as re,o as ce,p as he,q as le,r as ue,s as de,t as ge,u as me,v as fe,w as pe,x as ve,y as be,z as ye,A as we,B as ke,C as _e,E as Se,F as Ee,G as Te,H as Ce,J as Pe,K as Ie,L as Ae,_ as g,M as q,N as Me,O as qe,P as Ve,Q as v,R as ze,T as Be,U as Le,V as Oe,W as V,X as Re,Y as De}from"./vendor-Bx04Omqf.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const je="main-menu",xe=[{name:"dark",class:"dark",mainColor:"#000000"},{name:"light",class:"",mainColor:"#ffffff"}],O=["alpha","california","cburnett","chess7","chessnut","chicago","companion","fantasy","iowa","kosal","leipzig","letter","merida","mono","oslo","pirouetti","pixel","reilly","riohacha","shapes","spatial","symmetric"],T=[{name:"brown",styles:[{themeVariable:"--chess-white-background",value:"#F3E1C2"},{themeVariable:"--chess-white-color",value:"#C39976"},{themeVariable:"--chess-black-background",value:"#C39976"},{themeVariable:"--chess-black-color",value:"#F3E1C2"}]},{name:"blue",styles:[{themeVariable:"--chess-white-background",value:"#E4E9EB"},{themeVariable:"--chess-white-color",value:"#9DB1BB"},{themeVariable:"--chess-black-background",value:"#9DB1BB"},{themeVariable:"--chess-black-color",value:"#E4E9EB"}]},{name:"green",styles:[{themeVariable:"--chess-white-background",value:"#FFFEE4"},{themeVariable:"--chess-white-color",value:"#97B378"},{themeVariable:"--chess-black-background",value:"#97B378"},{themeVariable:"--chess-black-color",value:"#FFFEE4"}]},{name:"grey",styles:[{themeVariable:"--chess-white-background",value:"#AAAAAA"},{themeVariable:"--chess-white-color",value:"#888888"},{themeVariable:"--chess-black-background",value:"#888888"},{themeVariable:"--chess-black-color",value:"#AAAAAA"}]},{name:"pink",styles:[{themeVariable:"--chess-white-background",value:"#FFF2F2"},{themeVariable:"--chess-white-color",value:"#BC4545"},{themeVariable:"--chess-black-background",value:"#BC4545"},{themeVariable:"--chess-black-color",value:"#FFF2F2"}]},{name:"navy",styles:[{themeVariable:"--chess-white-background",value:"#ECECEC"},{themeVariable:"--chess-white-color",value:"#385170"},{themeVariable:"--chess-black-background",value:"#385170"},{themeVariable:"--chess-black-color",value:"#ECECEC"}]},{name:"dark-green",styles:[{themeVariable:"--chess-white-background",value:"#E0EFBA"},{themeVariable:"--chess-white-color",value:"#467A4B"},{themeVariable:"--chess-black-background",value:"#467A4B"},{themeVariable:"--chess-black-color",value:"#E0EFBA"}]},{name:"black-white",styles:[{themeVariable:"--chess-white-background",value:"#F2F2F2"},{themeVariable:"--chess-white-color",value:"#0C0C0C"},{themeVariable:"--chess-black-background",value:"#0C0C0C"},{themeVariable:"--chess-black-color",value:"#F2F2F2"}]}];class R{constructor(){l(this,"_listeners",[])}addEventListener(t){this._listeners.includes(t)||this._listeners.push(t)}removeEventListener(t){const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}removeListeners(){this._listeners=[]}notify(t){this._listeners.forEach(e=>{e(t)})}}const _=(o,t)=>`assets/pieces/${t}/${o}`,Fe=o=>o.endsWith("3.svg")?"three":o.endsWith("4.svg")?"four":o.endsWith("5.svg")?"five":o.endsWith("elementary.svg")?"elementary":o.endsWith("swords.svg")?"against":o.endsWith("B.svg")?"bishop":o.endsWith("K.svg")?"king":o.endsWith("N.svg")?"knight":o.endsWith("P.svg")?"pawn":o.endsWith("Q.svg")?"queen":o.endsWith("R.svg")?"rook":"unknown",We=o=>{window.document.title=o},Ne=(o,t)=>{window.document.getElementsByName(o)[0].content=t},z=(o,t)=>{const e=o.replace(".html","");We(window.AlpineI18n.t(`${e}.seo.title`,t)),Ne("description",window.AlpineI18n.t(`${e}.seo.meta_description`,t))};class D{constructor(t,e,s,i,n,a,r,d,u,m){l(this,"_configurationChangedEmitter",new R);this._stockfishDepth=t,this._stockfishMultiPV=e,this._preventScreenOff=s,this._colorTheme=i,this._playSounds=n,this._fullScreen=a,this._highlightSquares=r,this._pieceTheme=d,this._boardTheme=u,this._selectionUrl=m}serialize(){return{stockfishDepth:this._stockfishDepth,stockfishMultiPV:this._stockfishMultiPV,preventScreenOff:this._preventScreenOff,colorTheme:this._colorTheme,playSounds:this._playSounds,fullScreen:this._fullScreen,highlightSquares:this._highlightSquares,pieceTheme:this._pieceTheme,boardTheme:this._boardTheme,selectionUrl:this._selectionUrl}}get configuration(){return this}get configurationChangedEmitter(){return this._configurationChangedEmitter}get stockfishDepth(){return this._stockfishDepth}set stockfishDepth(t){this._stockfishDepth!=t&&(this._stockfishDepth=t,this._configurationChangedEmitter.notify({config:this,field:"stockfishDepth"}))}get stockfishMultiPV(){return this._stockfishMultiPV}set stockfishMultiPV(t){this._stockfishMultiPV!=t&&(this._stockfishMultiPV=t,this._configurationChangedEmitter.notify({config:this,field:"stockfishMultiPV"}))}get preventScreenOff(){return this._preventScreenOff}set preventScreenOff(t){this._preventScreenOff!=t&&(this._preventScreenOff=t,this._configurationChangedEmitter.notify({config:this,field:"preventScreenOff"}))}get colorTheme(){return this._colorTheme}set colorTheme(t){this._colorTheme!=t&&(this._colorTheme=t,this._configurationChangedEmitter.notify({config:this,field:"colorTheme"}))}get playSounds(){return this._playSounds}set playSounds(t){this._playSounds!=t&&(this._playSounds=t,this._configurationChangedEmitter.notify({config:this,field:"playSounds"}))}get fullScreen(){return this._fullScreen}set fullScreen(t){this._fullScreen!=t&&(this._fullScreen=t,this._configurationChangedEmitter.notify({config:this,field:"fullScreen"}))}get highlightSquares(){return this._highlightSquares}set highlightSquares(t){this._highlightSquares!=t&&(this._highlightSquares=t,this._configurationChangedEmitter.notify({config:this,field:"highlightSquares"}))}get pieceTheme(){return this._pieceTheme}set pieceTheme(t){this._pieceTheme!=t&&(this._pieceTheme=t,this._configurationChangedEmitter.notify({config:this,field:"pieceTheme"}))}get boardTheme(){return this._boardTheme}set boardTheme(t){this._boardTheme!=t&&(this._boardTheme=t,this._configurationChangedEmitter.notify({config:this,field:"boardTheme"}))}get selectionUrl(){return this._selectionUrl}set selectionUrl(t){this._selectionUrl!=t&&(this._selectionUrl=t,this._configurationChangedEmitter.notify({config:this,field:"selectionUrl"}))}}const p=new D(15,10,!0,"dark",!0,!0,!0,O[0],T[0].name,"https://gist.githubusercontent.com/supertorpe/c18a5f320db997e52f25aecac5f9ceb1/raw/54f4acb908dce74b94641d4d1f1ed3a035452375/equalizing-chess-selection.js");class Ue{constructor(){l(this,"store",new H({name:"CET_STORAGE",driverOrder:[M.IndexedDB,M.LocalStorage]}))}async init(){return this.store.create()}get(t){return this.store.get(t)}set(t,e){return this.store.set(t,e)}remove(t){return this.store.remove(t)}}const C=new Ue;class $e{constructor(){l(this,"_configuration")}get configuration(){return this._configuration}init(){return new Promise(t=>{C.get("CONFIGURATION").then(e=>{e?(e.stockfishDepth===void 0&&(e.stockfishDepth=p.stockfishDepth),e.stockfishMultiPV===void 0&&(e.stockfishMultiPV=p.stockfishMultiPV),e.preventScreenOff===void 0&&(e.preventScreenOff=p.preventScreenOff),e.colorTheme===void 0&&(e.colorTheme=p.colorTheme),e.playSounds===void 0&&(e.playSounds=p.playSounds),e.fullScreen===void 0&&(e.fullScreen=p.fullScreen),e.highlightSquares===void 0&&(e.highlightSquares=p.highlightSquares),e.pieceTheme===void 0&&(e.pieceTheme=p.pieceTheme),e.boardTheme===void 0&&(e.boardTheme=p.boardTheme),e.selectionUrl===void 0&&(e.selectionUrl=p.selectionUrl),this._configuration=new D(e.stockfishDepth,e.stockfishMultiPV,e.preventScreenOff,e.colorTheme,e.playSounds,e.fullScreen,e.highlightSquares,e.pieceTheme,e.boardTheme,e.selectionUrl),t(this._configuration)):(this._configuration=p,this.save().then(s=>{t(s)}))})})}save(){return C.set("CONFIGURATION",this._configuration.serialize())}}const h=new $e;document.documentElement.classList.add("ion-ce");function c(o,t){try{customElements.define(t,o)}catch{}}J();c(G,"ion-alert");c(K,"ion-app");c(Q,"ion-button");c(Y,"ion-buttons");c(X,"ion-card-content");c(Z,"ion-card-header");c(ee,"ion-card");c(te,"ion-card-title");c(se,"ion-col");c(ie,"ion-content");c(oe,"ion-fab-button");c(ne,"ion-fab");c(ae,"ion-fab-list");c(re,"ion-footer");c(ce,"ion-grid");c(he,"ion-header");c(le,"ion-icon");c(ue,"ion-input");c(de,"ion-item");c(ge,"ion-label");c(me,"ion-menu-button");c(fe,"ion-menu");c(pe,"ion-menu-toggle");c(ve,"ion-modal");c(be,"ion-range");c(ye,"ion-ripple-effect");c(we,"ion-router-link");c(ke,"ion-router-outlet");c(_e,"ion-row");c(Se,"ion-segment-button");c(Ee,"ion-segment");c(Te,"ion-split-pane");c(Ce,"ion-title");c(Pe,"ion-toast");c(Ie,"ion-toggle");c(Ae,"ion-toolbar");const He=Object.assign({"/node_modules/@ionic/core/dist/ionic/svg/arrow-back.svg":()=>g(()=>import("./arrow-back-D-orv5c1.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/arrow-forward.svg":()=>g(()=>import("./arrow-forward-Bnj_Gn2j.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/arrow-undo.svg":()=>g(()=>import("./arrow-undo-C-1zIByy.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/bulb.svg":()=>g(()=>import("./bulb-BQBTeG-f.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/caret-down.svg":()=>g(()=>import("./caret-down-CgdCcEJE.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/caret-forward.svg":()=>g(()=>import("./caret-forward-D90KpvAo.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/caret-up.svg":()=>g(()=>import("./caret-up-D9Gp9sHm.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/close.svg":()=>g(()=>import("./close-Da1lKQrP.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/color-wand.svg":()=>g(()=>import("./color-wand-BHrDbzBV.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/flag.svg":()=>g(()=>import("./flag-DD7xd5JK.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/home-sharp.svg":()=>g(()=>import("./home-sharp-MT0ovGxc.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/information-circle.svg":()=>g(()=>import("./information-circle-BFRZsY_T.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/power.svg":()=>g(()=>import("./power-6A_yMQ7H.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/save.svg":()=>g(()=>import("./save-6TErxtDE.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/settings-sharp.svg":()=>g(()=>import("./settings-sharp-b5VK1TDx.js"),__vite__mapDeps([])).then(o=>o.default),"/node_modules/@ionic/core/dist/ionic/svg/swap-vertical.svg":()=>g(()=>import("./swap-vertical-CwZ8QMVW.js"),__vite__mapDeps([])).then(o=>o.default)}),E=()=>{document.querySelectorAll("ion-icon").forEach(o=>{const t=o.getAttribute("data-name");t!=null&&He[`/node_modules/@ionic/core/dist/ionic/svg/${t}.svg`]().then(e=>{o.src=e})})};class Je{constructor(){l(this,"navigo");l(this,"menuRegistered",!1);l(this,"templates",new Map);l(this,"closeMenu",t=>{if(!this.menuRegistered){const e="ion-menu[menu-id='"+t+"']",s=document.querySelector(e);if(!s)return;q._register(s),this.menuRegistered=!0}q.close(t)});l(this,"openRoute",(t,e,s,i,n)=>(this.closeMenu(je),new Promise(a=>{const r=document.querySelector(s);if(r){const d=new MutationObserver(m=>{m.forEach(f=>{i&&(d.disconnect(),E(),t.updatePageLinks(),a())})});d.observe(r,{childList:!0}),i.onEnter(n);const u=this.templates.get(e);u?(r.innerHTML=u,z(e,i.getSEOParams())):fetch(e).then(m=>m.text().then(f=>{this.templates.set(e,f),r.innerHTML=f,z(e,i.getSEOParams()),E()}))}})))}open(t){return t.hasParams?e=>this.openRoute(this.navigo,t.template,t.tag,t.controller,e):()=>this.openRoute(this.navigo,t.template,t.tag,t.controller)}openModal(t,e,s,i,n,a){const r=document.createElement("div");r.setAttribute("x-data",t);const d=this.templates.get(e);return d?(r.innerHTML=d,this.innerOpenModal(r,s,i,n,a)):fetch(e).then(u=>u.text().then(async m=>(this.templates.set(e,m),r.innerHTML=m,this.innerOpenModal(r,s,i,n,a))))}async innerOpenModal(t,e,s,i,n){const a=await Me.create({component:t});i&&a.style.setProperty("--height","auto"),n&&e.setInfo(n),e.onEnter(n),a.present().then(()=>{E()}),s||requestAnimationFrame(()=>{s||t.classList.remove("ion-page")});const{data:r}=await a.onDidDismiss();return r}updatePageLinks(){this.navigo.updatePageLinks()}init(t){this.navigo=new qe(t.mainRoute.path,{hash:t.hash});const e=this.open(t.mainRoute);t.routes.forEach(s=>{const i=this.open(s);s.hasParams?this.navigo.on(s.path,n=>{document.querySelector(s.tag)?i(n.data):e().then(()=>i(n.data))},{leave(n,a){s.controller.onExit().then(r=>n(r))}}):this.navigo.on(s.path,()=>{document.querySelector(s.tag)?i():e().then(()=>i())})}),this.navigo.resolve()}}const I=new Je;class Ge{getThemes(){return xe}setTheme(t){var e,s;t=="dark"?(e=document.querySelector("body"))==null||e.classList.add("dark"):(s=document.querySelector("body"))==null||s.classList.remove("dark")}currentTheme(){var t;return(t=document.querySelector("body"))!=null&&t.classList.contains("dark")?"dark":"light"}init(){this.setTheme(h.configuration.colorTheme)}}const k=new Ge;class Ke{getThemes(){return T}setTheme(t){const e=T.find(s=>s.name==t);e&&e.styles.forEach(s=>{document.documentElement.style.setProperty(s.themeVariable,s.value)})}currentTheme(){return h.configuration.boardTheme}init(){this.setTheme(this.currentTheme())}}const j=new Ke;class Qe{constructor(){l(this,"stockfish");l(this,"_version");l(this,"_messageEmitter",new R)}get version(){return this._version}get messageEmitter(){return this._messageEmitter}postMessage(t){this.stockfish.postMessage(t)}initStockfish(t,e){const s=this;this.stockfish=new Worker(t),this.stockfish.addEventListener("message",function(i){s._messageEmitter.notify(i.data)}),this.stockfish.postMessage("uci"),e&&this.stockfish.postMessage("setoption name Use NNUE value true")}async initStockfishNnue16(){this.initStockfish("assets/stockfish/stockfish-nnue-16.js#stockfish-nnue-16.wasm",!0)}initStockfishNnue16NoSimd(){this.initStockfish("assets/stockfish/stockfish-nnue-16-no-simd.js#stockfish-nnue-16-no-simd.wasm",!0)}initStockfishNnue16Single(){this.initStockfish("assets/stockfish/stockfish-nnue-16-single.js#stockfish-nnue-16-single.wasm",!0)}initStockfishJs(){this.initStockfish("assets/stockfish/stockfish.asm.js",!1)}sharedMemoryTest(){if(typeof Atomics!="object"||typeof SharedArrayBuffer!="function")return!1;let t;try{if(t=new WebAssembly.Memory({shared:!0,initial:1,maximum:2}),!(t.buffer instanceof SharedArrayBuffer))return!1;window.postMessage(t.buffer,"*")}catch{return!1}return t.buffer instanceof SharedArrayBuffer}detectFeatures(){const t=[];if(typeof WebAssembly=="object"&&typeof WebAssembly.validate=="function"&&WebAssembly.validate(Uint8Array.from([0,97,115,109,1,0,0,0]))&&(t.push("wasm"),this.sharedMemoryTest())){t.push("sharedMem");const e=Uint8Array.from([0,97,115,109,1,0,0,0,1,12,2,96,2,123,123,1,123,96,1,123,1,123,3,3,2,0,1,7,9,2,1,97,0,0,1,98,0,1,10,19,2,9,0,32,0,32,1,253,186,1,11,7,0,32,0,253,253,1,11]);WebAssembly.validate(e)&&t.push("simd")}return t}init(){return new Promise(t=>{const e=i=>{this._version||(this._version=i),console.log(i),i=="uciok"&&t(!0)};this._messageEmitter.addEventListener(e);const s=this.detectFeatures();s.includes("simd")?this.initStockfishNnue16():s.includes("sharedMem")?this.initStockfishNnue16NoSimd():s.includes("wasm")?this.initStockfishNnue16Single():this.initStockfishJs()})}}const y=new Qe,Ye={app:{seo:{title:"Equalizing Chess",meta_description:"Equalizing Chess"},menu:"Menu",home:"Home",settings:"Settings",about:"About",exit:"Exit","back-to-exit":"Press back again to exit"},home:{seo:{title:"Equalizing Chess",meta_description:"Explore the unpredictable realm of Equalizing Chess, a web app that challenges the traditional norms of chess by providing a dynamic and adaptable playing experience. Embrace the unpredictability as the AI strives to match the skill level of human players, creating an engaging and level playing field for enthusiasts of all backgrounds. Whether you're a seasoned grandmaster or a casual player, Equalizing Chess ensures a unique and balanced chess encounter, where the pursuit of equality takes center stage. Immerse yourself in a chess adventure that mirrors the twists and turns of human intuition, making every move an exciting and strategic endeavor. Unleash the potential for thrilling matches with Equalizing Chess, where the pursuit of equality knows no bounds."},title:"Equalizing Chess","get-started":"Get Started",presentation:"Presentation",description:"Equalizing Chess is a chess game where the engine tries to play as well or as badly as the user. To do this, he tries to balance the position in each movement.","start-game":"New game: choose pieces"},position:{seo:{title:"Equalizing Chess",meta_description:"Equalizing Chess"},white:"white",black:"black",to:"to",checkmate:"checkmate",draw:"draw",moves:"moves","your-turn":"Your turn",congratulations:"Congratulations",review:"review","fen-clipboard":"FEN copied to clipboard",in:"in",ups:"Oooops!",ok:"OK","confirm-exit":{header:"Attention",message:"Sure to abandon the game?",no:"No",yes:"yes"}},chessboard:{stalemate:"Stalemate","three-repetition":"Three Repetition","rule-fifty":"Draw: fifty-move rule","game-over":"Game Over","mate-in":"You can reach mate in","white-advantage":"White advantage","black-advantage":"Black advantage","stockfish-slow":"Stockfish is working slow. Consider lowering the search depth in configuration screen."},settings:{seo:{title:"Settings - Equalizing Chess",meta_description:"Settings of 'Equalizing Chess'"},title:"Settings","theme-dark":"Dark","theme-light":"Light","clean-database":"Reset records","records-removed":"Records removed","color-theme":"Color theme","piece-theme":"Pieces style","board-theme":"Board theme","save-changes":"Save changes","changes-saved":"Changes saved","goto-position":"Show puzzle at the beginning","play-sounds":"Sound","highlight-squares":"Highlight squares","prevent-screen-off":"Keep screen on","full-screen":"Full screen mode","use-syzygy":"Use Syzygy tables","stockfish-depth":"Stockfish depth","stockfish-multipv":"Stockfish MultiPV","clean-dialog":{title:"Are you sure?",subtitle:"Reset records",message:"All your records will be lost !!!",cancel:"Cancel",continue:"Continue"}},about:{seo:{title:"Information - Equalizing Chess",meta_description:"Version information and 3dparty resources used in Equalizing Chess"},title:"About",description:"Equalizing Chess (v{version}) is a free and open source project.","source-code":"See project's source code","third-party":"Following software and resources has been used:","chessjs-description":"chess.js: a Javascript chess library for chess move generation/validation, piece placement/movement, and check/checkmate/draw detection","chessground-description":"chessground: a Javascript chess board","stockfish-js-description":"Stockfish.js: WASM implementation of Stockfish chess engine by Nathan Rugg (nmrugg)<br/>{stockfishRunningVersion}",typescript:"TypeScript: JavaScript with syntax for types",ionic:"Ionic Framework: the mobile sdk for the web","alpine-js":"Alpine.js: lightweight JavaScript framework","alpinejs-i18n":"Alpine i18n: Internationalization (i18n) support for Alpine.js",navigo:"Navigo: a simple vanilla JavaScript router",howlerjs:"Javascript audio library for the modern web","enable-threads":"enable-threads.js: creates a service worker that cross-origin-isolates the page",vite:"Vite: fast build tool",logo:"Logo: designed by Inipagi from Iconfinder",pacifier:"Pacifier: designed by Smashicons from Flaticon",pieces:"Chess pieces: from their respective authors (see details...)",font:"Russo One: text font by Jovanny Lemonad","move-sound":"Move sound: from lichess static resources","capture-sound":"Capture sound: from lichess static resources","success-sound":"Success sound: shinephoenixstormcrow from freesound.org","fail-sound":"Fail sound: Bertrof from freesound.org"}},Xe={app:{seo:{title:"Equalizing Chess",meta_description:"Equalizing Chess..."},menu:"Menú",home:"Inicio",settings:"Configuración",about:"Acerca de",exit:"Salir","back-to-exit":"Pulse 'atrás' de nuevo para salir"},home:{seo:{title:"Equalizing Chess",meta_description:"Equalizing Chess..."},title:"Equalizing Chess","get-started":"Inicio",presentation:"Presentación",description:"Equalizing Chess es un juego de ajedrez donde el motor intenta jugar tan bien o mal como el usuario. Para ello, él intenta balancear la posición en cada movimiento.","start-game":"Nueva partida: elige piezas"},list:{seo:{title:"Equalizing Chess",meta_description:"Posiciones para practicar finales de ajedrez: {kind}"}},category:{Basic:"Básicos",Pawn:"Peones",Bishop:"Alfiles",Knight:"Caballos","Knight-Bishop":"Caballos y Alfiles","Rook-Pawn":"Torres y Peones","Rook-Pieces":"Torres y Piezas",Queen:"Dama"},position:{seo:{title:"Posición con {kind} - Equalizing Chess",meta_description:"Posición para practicar el fin de juego de ajedrez: {kind}"},white:"blancas",black:"negras",to:"buscan",checkmate:"mate",draw:"tablas","personal-record":"Record personal",moves:"movimientos","your-turn":"Tu turno","used-assistance":"Ha usado ayuda, no se registra record","new-record":"¡Nuevo record personal!","goal-achieved":"Objetivo alcanzado",congratulations:"Enhorabuena",review:"revisar","next-puzzle":"siguiente puzzle","fen-clipboard":"FEN copiado al portapapeles",in:"en",ups:"¡Ohhh!","keep-practicing":"sigue practicando, ¡lo conseguirás!",ok:"Aceptar","confirm-exit":{header:"Atención",message:"¿Seguro de abandonar la partida?",no:"No",yes:"Sí"}},chessboard:{stalemate:"Ahogado","insufficent-material":"Material insuficiente","three-repetition":"Triple repetición","rule-fifty":"Tablas: regla 50 movimientos","game-over":"Fin del juego","mate-in":"Puedes conseguir mate en","receive-mate-in":"Vas a recibir mate","unfeasible-mate":"Mate inviable","white-advantage":"Ventaja blancas","black-advantage":"Ventaja negras","querying-syzygy":"Consultando Syzygy...","syzygy-error":"Error en Syzygy. Cambiando a Stockfish","stockfish-slow":"Stockfish está tardando mucho. Puede bajar la profundidad de búsqueda en la pantalla de configuración."},settings:{seo:{title:"Configuración - Equalizing Chess",meta_description:"Configuración de 'Equalizing Chess'"},title:"Configuración","theme-dark":"Oscuro","theme-light":"Claro","clean-database":"Eliminar records","records-removed":"Records eliminados","color-theme":"Apariencia","piece-theme":"Estilo de piezas","board-theme":"Colores del tablero","save-changes":"Guardar cambios","changes-saved":"Cambios guardados","goto-position":"Mostrar puzzle al iniciar","play-sounds":"Sonido","highlight-squares":"Iluminar casillas","prevent-screen-off":"Mantener pantalla encendida","full-screen":"Ocupar toda la pantalla","use-syzygy":"Usar tablas Syzygy","stockfish-depth":"Stockfish depth","stockfish-multipv":"Stockfish MultiPV","clean-dialog":{title:"¿Está seguro?",subtitle:"Eliminar records",message:"¡Se perderán todos tus records!",cancel:"Cancelar",continue:"Continuar"}},about:{seo:{title:"Información - Equalizing Chess",meta_description:"Información de la versión y recursos de terceros utilizados en 'Equalizing Chess'"},title:"Acerca de",description:"Equalizing Chess (v{version}) es un proyecto open source","source-code":"Ver código fuente del proyecto","third-party":"Para su desarrollo se ha utilizado el siguiente software y recursos de terceros:","chessjs-description":"chess.js: librería Javascript para la generación / validación / posicionamiento de movimientos de piezas, y detección de jaque, mate y tablas","chessground-description":"chessground: un tablero de ajedrez en Javascript","stockfish-js-description":"Stockfish.js: implementación WASM del motor de ajedrez Stockfish por Nathan Rugg (nmrugg)<br/>{stockfishRunningVersion}",ionic:"Ionic Framework: el SDK móvil para la web",typescript:"TypeScript: JavaScript con sintaxis para tipos","alpine-js":"Alpine.js: framework javascript ligero","alpinejs-i18n":"Alpine i18n: plugin de internacionalización para Alpine.js",navigo:"Navigo: un enrutador JavaScript básico",howlerjs:"Librería Javascript de audio para la web moderna","enable-threads":"enable-threads.js: crea un service worker que aísla la página 'cross-origin'",vite:"Vite: herramienta de construcción rápida",logo:"Logo: diseñado por Inipagi en Iconfinder",pacifier:"Chupete: diseñado por Smashicons en Flaticon",pieces:"Piezas de ajedrez: de sus respectivos autores (ver detalles...)",font:"Russo One: fuente de texto de Jovanny Lemonad","move-sound":"Audio de movimiento: recursos estáticos de Lichess","capture-sound":"Audio de captura: recursos estáticos de Lichess","success-sound":"Audio de éxito: shinephoenixstormcrow en freesound.org","fail-sound":"Audio de fallo: Bertrof from freesound.org"}},S={en:Ye,es:Xe},Ze=[{url:"https://github.com/jhlywa/chess.js",i18n:"about.chessjs-description"},{url:"https://github.com/lichess-org/chessground",i18n:"about.chessground-description"},{url:"https://github.com/nmrugg/stockfish.js",i18n:"about.stockfish-js-description"},{url:"https://www.typescriptlang.org",i18n:"about.typescript"},{url:"https://ionicframework.com",i18n:"about.ionic"},{url:"https://alpinejs.dev",i18n:"about.alpine-js"},{url:"https://github.com/rehhouari/alpinejs-i18n",i18n:"about.alpinejs-i18n"},{url:"https://github.com/krasimir/navigo",i18n:"about.navigo"},{url:"https://github.com/goldfire/howler.js",i18n:"about.howlerjs"},{url:"https://github.com/josephrocca/clip-image-sorter/blob/main/enable-threads.js",i18n:"about.enable-threads"},{url:"https://vitejs.dev",i18n:"about.vite"},{url:"https://www.iconfinder.com/icons/1688870/business_chess_strategy_icon",i18n:"about.logo"},{url:"https://github.com/supertorpe/equalizing-chess",i18n:"about.pieces"},{url:"https://fonts.google.com/specimen/Russo+One",i18n:"about.font"},{url:"https://github.com/lichess-org/lila/blob/master/public/sound/standard/Move.mp3",i18n:"about.move-sound"},{url:"https://github.com/lichess-org/lila/blob/master/public/sound/standard/Capture.mp3",i18n:"about.capture-sound"},{url:"https://freesound.org/people/shinephoenixstormcrow/sounds/337049/",i18n:"about.success-sound"},{url:"https://freesound.org/people/Bertrof/sounds/131657/",i18n:"about.fail-sound"}],et={items:Ze},tt=[{key:"move",audio:"assets/audio/move.mp3"},{key:"capture",audio:"assets/audio/capture.mp3"},{key:"success",audio:"assets/audio/success.mp3"},{key:"fail",audio:"assets/audio/fail.mp3"}],st={sounds:tt};class it{constructor(){l(this,"sounds",[])}playAudio(t){if(h.configuration.playSounds){const e=this.sounds.find(s=>s.key===t);e&&(t!=="fail"||!e.audio.playing())&&e.audio.play()}}init(){st.sounds.forEach(t=>this.sounds.push({key:t.key,audio:new Ve.Howl({src:[t.audio]})}))}}const P=new it;class ot{hideLoader(){const t=document.querySelector(".loader-container");t&&t.remove()}i18n(){document.addEventListener("alpine-i18n:ready",()=>{const t=navigator.language;let e="",s=!1;Object.keys(S).forEach(i=>{window.AlpineI18n.fallbackLocale||(window.AlpineI18n.fallbackLocale=i),s||(i==t?(window.AlpineI18n.create(i,S),s=!0,document.documentElement.lang=i):!e&&t.startsWith(i)&&(e=i))}),s||(e?(window.AlpineI18n.create(e,S),document.documentElement.lang=e):(window.AlpineI18n.create(window.AlpineI18n.fallbackLocale,S),document.documentElement.lang=window.AlpineI18n.fallbackLocale))})}init(){this.i18n(),v.plugin(ze),v.start(),this.hideLoader()}}const nt=new ot;function at(){return C.init().then(()=>h.init()).then(()=>y.init()).then(()=>P.init()).then(()=>k.init()).then(()=>j.init()).then(()=>nt.init())}class w{setInfo(t){}getSEOParams(){return{}}onEnter(t){}onExit(){return new Promise(t=>{t(!0)})}}const rt="1.0.0-alpha.1";class ct extends w{onEnter(t){v.data("info",()=>({version:rt,items:et.items.map(e=>({url:e.url,text:window.AlpineI18n.t(e.i18n,{stockfishRunningVersion:y.version})}))}))}}const ht=new ct;class lt extends w{onEnter(t){v.data("settings",()=>({color:k.currentTheme()=="dark"?"w":"b",showThemes:!1,themes:k.getThemes(),currentTheme(){return h.configuration.colorTheme},toggleThemes(){this.showThemes=!this.showThemes,this.showPieceThemes=!1,this.showBoardThemes=!1},setTheme(e){k.setTheme(e),h.configuration.colorTheme=e,this.color=k.currentTheme()=="dark"?"w":"b"},showPieceThemes:!1,pieceThemes:O,currentPieceTheme:h.configuration.pieceTheme,togglePieceThemes(){this.showPieceThemes=!this.showPieceThemes,this.showThemes=!1,this.showBoardThemes=!1},setPieceTheme(e){this.currentPieceTheme=e,h.configuration.pieceTheme=e},showBoardThemes:!1,boardThemes:T,currentBoardTheme:h.configuration.boardTheme,toggleBoardThemes(){this.showBoardThemes=!this.showBoardThemes,this.showThemes=!1,this.showPieceThemes=!1},setBoardTheme(e){this.currentBoardTheme=e,h.configuration.boardTheme=e,j.setTheme(e)},playSounds:h.configuration.playSounds,playSoundsChanged(e){this.playSounds=e,h.configuration.playSounds=e},highlightSquares:h.configuration.highlightSquares,highlightSquaresChanged(e){this.highlightSquares=e,h.configuration.highlightSquares=e},currentStockfishDepth:h.configuration.stockfishDepth,changeStockfishDepth(e){this.currentStockfishDepth=e,h.configuration.stockfishDepth=e},currentStockfishMultiPV:h.configuration.stockfishMultiPV,changeStockfishMultiPV(e){this.currentStockfishMultiPV=e,h.configuration.stockfishMultiPV=e},currentSelectionUrl:h.configuration.selectionUrl,changeSelectionUrl(){const e=document.getElementById("inputSelectionUrl").value;this.currentSelectionUrl=e,h.configuration.selectionUrl=e},save(){h.save().then(async()=>{(await Be.create({message:window.AlpineI18n.t("settings.changes-saved"),position:"middle",color:"success",duration:1e3})).present(),this.close()})},close(){document.querySelector("ion-modal").dismiss()},init(){const e=document.getElementById("toggleHighlightSquares");e.addEventListener("ionChange",()=>{this.highlightSquaresChanged(e.checked)});const s=document.getElementById("togglePlaySounds");s.addEventListener("ionChange",()=>{this.playSoundsChanged(s.checked)});const i=document.getElementById("stockfishDepthRange");i.value=h.configuration.stockfishDepth,i.addEventListener("ionChange",()=>{typeof i.value=="number"&&this.changeStockfishDepth(i.value)});const n=document.getElementById("stockfishMultiPVRange");n.value=h.configuration.stockfishMultiPV,n.addEventListener("ionChange",()=>{typeof n.value=="number"&&this.changeStockfishMultiPV(n.value)}),["showThemes","showPieceThemes","showBoardThemes"].forEach(a=>{this.$watch(a,r=>{E()})}),document.getElementById("stockfishDepthRange").pinFormatter=a=>a,document.getElementById("stockfishMultiPVRange").pinFormatter=a=>a}}))}}const x=new lt;class ut extends w{onEnter(t){v.data("info",()=>({showSettings(){I.openModal("settings","settings.html",x,!0,!1)},init(){}}))}}const dt=new ut;class gt extends w{onEnter(t){const e=h.configuration.pieceTheme;v.data("info",()=>({iconWhite:_("wP.svg",e),iconBlack:_("bP.svg",e),init(){h.configuration.configurationChangedEmitter.addEventListener(s=>{s.field=="pieceTheme"&&(this.iconWhite=_("wP.svg",s.config.pieceTheme),this.iconBlack=_("bP.svg",s.config.pieceTheme))})}}))}}const B=new gt;class mt extends w{constructor(){super(...arguments);l(this,"player")}setInfo(e){this.player=e}onEnter(e){v.data("promotion",()=>({player:this.player,currentPieceTheme:h.configuration.pieceTheme,select(s){document.querySelector("ion-modal").dismiss({piece:s})}}))}}const F=new mt;class ft extends w{constructor(){super();l(this,"seo");l(this,"chess",Le());l(this,"board");l(this,"boardConfig");l(this,"parsedPgn");l(this,"player");l(this,"engine");l(this,"listeningToStockfish",!1);l(this,"stockfishMessageBuffer",[]);l(this,"selectCandidateFunction");y.messageEmitter.addEventListener(e=>this.stockfishMessage(e))}async loadSelectionFunction(){try{const s=await(await fetch(h.configuration.selectionUrl)).text(),{selectCandidate:i}=await g(()=>import(`data:text/javascript;charset=utf-8,${encodeURIComponent(s)}`),__vite__mapDeps([]));this.selectCandidateFunction=i}catch(e){console.log(e),alert("Error loading selection function. Using default algorithm"),this.selectCandidateFunction=this.selectEqualizingCandidate}}resizeBoard(){const s=Array.from(document.querySelectorAll("ion-header")).find(N=>N.clientHeight>0);if(!s)return;const i=document.querySelector(".container"),n=document.querySelector(".board_wrapper"),a=document.querySelector(".gauge"),r=document.querySelector(".info_wrapper"),d=document.querySelector(".action_buttons"),u=i.clientWidth,m=i.clientHeight-s.clientHeight;let f=Math.min(u,m);n.style.height=`${f}px`,n.style.width=`${f}px`,u>m?(r.style.width=`${u-f-2}px`,r.style.height="100%"):(r.style.width="100%",r.style.height=`${m-f-2}px`),d.style.width=r.style.width;const A=document.getElementById("__chessboard__"),W=n.clientWidth%8;let b=n.clientWidth-W;n.clientWidth-b<4&&(b=b-8),A.style.height=`${b}px`,A.style.width=`${b}px`,a.style.height=`${b}px`,a.style.width=`${n.clientWidth-b}px`}parsePgn(e){if(this.parsedPgn=[],e=="")return;const s=e.split(".");let i=0;s.forEach(n=>{if(i>0){let a=n.trim().split(" ",2);this.parsedPgn.push(a)}i++})}toDests(){const e=new Map;return Oe.forEach(s=>{const i=this.chess.moves({square:s,verbose:!0});i.length&&e.set(s,i.map(n=>n.to))}),e}onEnter(e){const s=this;this.selectCandidateFunction||this.loadSelectionFunction();const i=e.fen1!==void 0;let n;i?n=`${e.fen1}/${e.fen2}/${e.fen3}/${e.fen4}/${e.fen5}/${e.fen6}/${e.fen7}/${e.fen8}`:n="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",this.seo=n,this.chess.load(n),this.parsePgn(this.chess.pgn());const a=this.chess.turn()=="w",r=a?"white":"black",d=a?"white":"black";this.player=e.color||(this.chess.turn()=="w"?V[0]:V[1]),this.engine=this.player=="white"?"black":"white",this.boardConfig={fen:this.chess.fen(),orientation:this.player,viewOnly:!1,turnColor:r,premovable:{enabled:!1},movable:{free:!1,color:r,dests:this.toDests(),showDests:h.configuration.highlightSquares,events:{after:(u,m,f)=>{this.afterMove(u,m)}}},highlight:{lastMove:!0,check:!0},draggable:{enabled:!0,autoDistance:!0,showGhost:!0},selectable:{enabled:!0}},window.addEventListener("resize",function(){s.resizeBoard()}),v.data("info",()=>({boardTheme:h.configuration.boardTheme,pieceTheme:h.configuration.pieceTheme,customFen:i,fen:n,parsedPgn:s.parsedPgn,move:d,ariaDescriptionFromIcon:Fe,chess:this.chess,init(){const u=document.querySelector(".gauge_top"),m=document.querySelector(".gauge_bottom");u.style.backgroundColor=s.player=="white"?"dimgray":"white",m.style.backgroundColor=s.player=="white"?"white":"dimgray",s.board=De(document.getElementById("__chessboard__"),s.boardConfig),requestAnimationFrame(()=>{s.resizeBoard()}),h.configuration.configurationChangedEmitter.addEventListener(f=>{switch(f.field){case"boardTheme":this.boardTheme=f.config.boardTheme;break;case"pieceTheme":this.pieceTheme=f.config.pieceTheme;break;case"highlightSquares":{s.boardConfig.movable&&s.board.set({movable:{showDests:f.config.highlightSquares}});break}case"stockfishMultiPV":s.updateStockfishMultiPV();break;case"selectionUrl":s.loadSelectionFunction();break}})}})),this.updateStockfishMultiPV(),this.player=="black"&&this.getStockfishMove()}updateStockfishMultiPV(){y.postMessage(`setoption name MultiPV value ${h.configuration.stockfishMultiPV}`)}afterMove(e,s){var i;e=="a0"||s=="a0"||(((i=this.chess.get(e))==null?void 0:i.type)=="p"&&(s.charAt(1)=="8"||s.charAt(1)=="1")?I.openModal("promotion","promotion.html",F,!1,!0,this.player[0]).then(n=>{this.registerMove(e,s,n.piece)}):this.registerMove(e,s,void 0))}registerMove(e,s,i){this.chess.move({from:e,to:s,promotion:i}),i&&this.board.set({fen:this.chess.fen()}),console.log(this.chess.fen()),P.playAudio("move"),this.chess.game_over()?this.chess.in_checkmate()?this.chess.turn()=="w"?alert("negras ganan"):alert("blancas ganan"):alert("empate"):this.getStockfishMove()}getStockfishMove(){y.postMessage("position fen "+this.chess.fen()),this.listeningToStockfish=!0,this.stockfishMessageBuffer=[],y.postMessage(`go depth ${h.configuration.stockfishDepth}`)}selectEqualizingCandidate(e){let s;const i=e.filter(a=>a.score>=0),n=e.filter(a=>a.score<0);if(i.length>0){const a=Math.min(...i.map(u=>u.score)),r=i.filter(u=>u.score===a),d=Math.floor(Math.random()*r.length);s=r[d]}else if(n.length>0){const a=Math.max(...n.map(u=>u.score)),r=n.filter(u=>u.score===a),d=Math.floor(Math.random()*r.length);s=r[d]}else s=void 0;return s}stockfishMessage(e){if(!this.listeningToStockfish)return;let s;if(s=e.match(/^bestmove ([a-h][1-8])([a-h][1-8])([qrbn])?/)){this.listeningToStockfish=!1,console.log(JSON.stringify(this.stockfishMessageBuffer));let i=this.selectCandidateFunction(this.stockfishMessageBuffer);if(!i||!this.stockfishMessageBuffer.includes(i))return;console.log(`selected: ${JSON.stringify(i)}`),this.updateGauge(i.score);const n=i.pv.substring(0,2),a=i.pv.substring(2,4),r=i.pv.length==5&&(i.pv[4]=="r"||i.pv[4]=="n"||i.pv[4]=="b"||i.pv[4]=="q")?i.pv[4]:void 0;this.chess.move({from:n,to:a,promotion:r});const d=this.chess.turn()==="w"?"white":"black";this.board.set({fen:this.chess.fen(),turnColor:d,movable:{color:d,dests:this.toDests()}}),console.log(this.chess.fen()),P.playAudio("move")}else if(s=e.match(/^info depth (\d+) .*score cp (-?\d+) .*pv (\w+\d\w+)/)){const i=parseInt(s[1]),n=parseInt(s[2]),a=s[3];this.updateGauge(n),i==h.configuration.stockfishDepth&&(this.stockfishMessageBuffer.push({score:n,pv:a}),console.log(`score: ${n}`))}}updateGauge(e){const s=this.povChances(this.engine,void 0,e);console.log(`povChances: ${s}`);const i=document.querySelector(".gauge_top"),n=document.querySelector(".gauge_bottom"),a=100-(s+1)*50,r=100-a;i.style.height=`${this.player=="white"?a:r}%`,n.style.height=`${this.player=="white"?r:a}%`}getSEOParams(){return{kind:this.seo}}onExit(){return new Promise(async e=>{(await Re.create({header:window.AlpineI18n.t("position.confirm-exit.header"),message:window.AlpineI18n.t("position.confirm-exit.message"),buttons:[{text:window.AlpineI18n.t("position.confirm-exit.no"),role:"cancel",cssClass:"overlay-button",handler:()=>{e(!1)}},{text:window.AlpineI18n.t("position.confirm-exit.yes"),cssClass:"overlay-button",handler:()=>{y.postMessage("stop"),e(!0)}}]})).present()})}toPov(e,s){return e==="white"?s:-s}rawWinningChances(e){return 2/(1+Math.exp(-.00368208*e))-1}mateWinningChances(e){const i=(21-Math.min(10,Math.abs(e)))*100*(e>0?1:-1);return this.rawWinningChances(i)}cpWinningChances(e){return this.rawWinningChances(Math.min(Math.max(-1e3,e),1e3))}evalWinningChances(e,s){return typeof e<"u"?this.mateWinningChances(e):this.cpWinningChances(s)}povChances(e,s,i){return this.toPov(e,this.evalWinningChances(s,i))}}const L=new ft,pt={hash:!0,mainRoute:{path:"/equalizing-chess/",template:"app.html",tag:"ion-app",controller:dt,hasParams:!1},routes:[{path:"/",template:"home.html",tag:"ion-router-outlet",controller:B,hasParams:!1},{path:"/home",template:"home.html",tag:"ion-router-outlet",controller:B,hasParams:!1},{path:"/about",template:"about.html",tag:"ion-router-outlet",controller:ht,hasParams:!1},{path:"/settings",template:"settings.html",tag:"ion-router-outlet",controller:x,hasParams:!1},{path:"/game/:color",template:"position.html",tag:"ion-router-outlet",controller:L,hasParams:!0},{path:"/fen/:fen1/:fen2/:fen3/:fen4/:fen5/:fen6/:fen7/:fen8",template:"position.html",tag:"ion-router-outlet",controller:L,hasParams:!0},{path:"/promotion",template:"promotion.html",tag:"ion-router-outlet",controller:F,hasParams:!1}]};at().then(()=>{I.init(pt)});
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=index-DnyO3rib.js.map
